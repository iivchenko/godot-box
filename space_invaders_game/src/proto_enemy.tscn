[gd_scene load_steps=4 format=2]

[ext_resource path="res://assets/sprites/proto_enemy.png" type="Texture" id=1]

[sub_resource type="GDScript" id=1]
script/source = "extends KinematicBody2D

var Bullet = preload(\"res://src/proto_bullet.tscn\")

export var _lifes = 3
export var _shoot_max_delay = 1.0

var _shoot_delay = 0.0

func _process(delta: float) -> void:
	_shoot_delay = max(0.0, _shoot_delay - delta)


func can_shoot() -> bool:
	return _shoot_delay <= 0.0

func shoot() -> void:
	if can_shoot():
		_shoot_delay = _shoot_max_delay
		var bullet = Bullet.instance()
		bullet._color = Color.pink
		bullet._damage = 1
		bullet._max_speed = 150
		bullet._target = \"player\"
		bullet.global_position = $ShootingPoint.global_position
		bullet.direction = Vector2.DOWN
		get_tree().root.add_child(bullet)
	
func damage(damage: int) -> void:
	_lifes -= damage
	
	if _lifes <= 0:
		queue_free()
"

[sub_resource type="RectangleShape2D" id=2]
extents = Vector2( 16, 16 )

[node name="ProtoEnemy" type="KinematicBody2D"]
collision_layer = 2147483656
collision_mask = 0
script = SubResource( 1 )

[node name="Sprite" type="Sprite" parent="."]
texture = ExtResource( 1 )

[node name="Body" type="CollisionShape2D" parent="."]
shape = SubResource( 2 )

[node name="ShootingPoint" type="Position2D" parent="."]
position = Vector2( 0, 16 )
